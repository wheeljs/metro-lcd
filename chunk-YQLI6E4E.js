import{a as ne,b as Me,d as Fe}from"./chunk-VSQXB3HK.js";import{$ as Q,B as E,C as P,D as _e,Da as Pe,H as ve,J as xe,K as Ce,L as d,La as le,M as C,Ma as se,Q as y,R as f,S as T,T as k,U as O,Ua as V,Va as Te,W as B,Wa as U,X as D,Y as r,Z as l,_ as g,aa as M,ab as ee,ba as h,bb as te,c as ue,ca as x,cb as Oe,d as Z,da as ye,ea as Se,eb as Ie,fa as be,ga as W,ha as p,i as J,ia as S,ib as Le,j as H,ja as F,k as fe,n as ge,oa as we,pa as Ee,q as R,qa as Y,qb as $e,r as z,ra as I,rb as Ae,sa as L,sb as ke,ta as K,v as _,w as G,xa as X,y as he,ya as q}from"./chunk-WZBIZ7K5.js";import{a as j,b as me,d as qe}from"./chunk-2H7K6JAD.js";var De=function(i){return i.Default="default",i.Faster="faster",i}(De||{}),ie=(()=>{let t=class t{constructor(){this.splitorIcon=ne,this.animating=!0,this.color="#000",this.speed=De.Default}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=_({type:t,selectors:[["lcd-splitor"]],hostAttrs:[1,"lcd-splitor"],hostVars:6,hostBindings:function(n,e){n&2&&(T("color",e.color),k("lcd-splitor--animate-faster",e.speed==="faster")("lcd-splitor--animating",e.animating))},inputs:{animating:"animating",color:"color",speed:"speed"},decls:5,vars:5,consts:[[3,"icon"]],template:function(n,e){n&1&&g(0,"fa-icon",0)(1,"fa-icon",0)(2,"fa-icon",0)(3,"fa-icon",0)(4,"fa-icon",0),n&2&&(f("icon",e.splitorIcon),d(),f("icon",e.splitorIcon),d(),f("icon",e.splitorIcon),d(),f("icon",e.splitorIcon),d(),f("icon",e.splitorIcon))},dependencies:[V],styles:[`.lcd-splitor{display:flex;flex-direction:row}.lcd-splitor--animating>:nth-child(1){animation:1.5s .25s infinite splitor-animation}.lcd-splitor--animating>:nth-child(2){animation:1.5s .5s infinite splitor-animation}.lcd-splitor--animating>:nth-child(3){animation:1.5s .75s infinite splitor-animation}.lcd-splitor--animating>:nth-child(4){animation:1.5s 1s infinite splitor-animation}.lcd-splitor--animating>:nth-child(5){animation:1.5s 1.25s infinite splitor-animation}.lcd-splitor--animate-faster>:nth-child(n){animation-duration:.85s}@keyframes splitor-animation{0%{opacity:0}to{opacity:1}}
`],encapsulation:2,changeDetection:0});let i=t;return i})();var s=function(i){return i.NotInService="not-in-service",i.OnTheWay="on-the-way",i.ArrivingSoon="arriving-soon",i.Arrived="arrived",i.Past="past",i}(s||{});var A=(()=>{let t=class t{constructor(){this.running=new Z(null),this.playlist$=this.runningState$.pipe(H(o=>o!=null),J(o=>{let{current:n,next:e}=o,a;switch(n.status!==s.Past?a=n:a=e,a.status){case s.ArrivingSoon:case s.Arrived:return a.voices?.[a.status]??{};default:return{}}}),J(o=>{if(Object.keys(o).length===0)return[];let{ch:n,en:e}=o,a=[];for(let u=0;u<n.length;u++){let w=n[u],pe=e[u];w&&a.push(se.VoicesPrefix.ch+w),pe&&a.push(se.VoicesPrefix.en+pe)}return e.length>n.length&&a.push(...e.slice(n.length).filter(u=>typeof u=="string"&&u.length>0)),a}))}get runningState$(){return this.running.asObservable()}init(o,n){let e=j({},o);if(e.stations=o.stations.map(a=>me(j({},a),{status:s.OnTheWay,disabled:n?.disabledStations?.includes?.(a.id)})),o.direction==="down"&&(e.stations=e.stations.reverse()),e.from=e.stations[0],n.from){let a=e.stations.findIndex(u=>u.id===n.from);a!==-1&&(e.stations.slice(0,a).forEach(u=>u.status=s.NotInService),e.from=e.stations[a])}if(e.to=e.stations.at(-1),n.to){let a=e.stations.findIndex(u=>u.id===n.to);a&&(e.stations.slice(a+1).forEach(u=>u.status=s.NotInService),e.to=e.stations[a])}return this.runningLine=e,this.setStartStation(),this.runningLine}getNextStation(o){let{stations:n}=this.runningLine,e=o+1;if(e===n.length)return null;let a=n[e];return a.disabled?this.getNextStation(e):{index:e,station:a}}setStartStation(){let{from:o,stations:n}=this.runningLine;for(let e=0;e<n.length;e++){let a=n[e];if(o===a){o.status=s.ArrivingSoon;let u=this.getNextStation(e);this.running.next({current:Object.assign(o),next:u?Object.assign(u):null});break}}}next(){let{stations:o}=this.runningLine,n=o.findIndex(w=>w.status===s.ArrivingSoon||w.status===s.Arrived);if(n===-1)return;let e=o[n],{index:a,station:u}=this.getNextStation(n)??{};switch(e.status){case s.ArrivingSoon:e.status=s.Arrived;break;case s.Arrived:if(e.id===this.runningLine.to.id)return;if(e.status=s.Past,u){if(typeof a=="number"&&a>n+1)for(let w=n+1;w<a;w++)o[w].status=s.Past;u.status=s.ArrivingSoon}break}this.running.next({current:Object.assign(e),next:u?Object.assign(u):null})}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=R({token:t,factory:t.\u0275fac});let i=t;return i})();var oe=(()=>{let t=class t{transform(o){if(!o||!o.main)return"";let{prefix:n,main:e,suffix:a}=o;return[n,e,a].filter(u=>u).join("")}};t.\u0275fac=function(n){return new(n||t)},t.\u0275pipe=he({name:"lineName",type:t,pure:!0});let i=t;return i})();function Ue(i,t){if(i&1&&(r(0,"div",15)(1,"span",16),p(2,"\u4E0B\u4E00\u7AD9"),l(),r(3,"span",17),p(4,"Next"),l()(),r(5,"div",18)(6,"span",16),p(7),l(),r(8,"span",17),p(9),I(10,"stripNewLine"),l()()),i&2){let m=x();d(7),S(m.nameCh),d(2),F(" ",L(10,2,m.nameEn)," ")}}function et(i,t){if(i&1&&(r(0,"div",15)(1,"span",16),p(2,"\u5230\u8FBE\u7AD9"),l(),r(3,"span",17),p(4,"Arrived"),l()(),r(5,"div",18)(6,"span",16),p(7),l(),r(8,"span",17),p(9),I(10,"stripNewLine"),l()()),i&2){let m=x();d(7),S(m.nameCh),d(2),F(" ",L(10,2,m.nameEn)," ")}}function tt(i,t){if(i&1&&y(0,Ue,11,4)(1,et,11,4),i&2){let m=t;O(0,m.status==="arriving-soon"?0:m.status==="arrived"?1:-1)}}var Ne=(()=>{let t=class t{constructor(o){this.runningLineService=o,this.splitorIcon=ne,this.running$=o.runningState$.pipe(H(n=>n!=null),J(n=>{let{current:e}=n;return e.status!==s.Past?e:n.next}))}};t.\u0275fac=function(n){return new(n||t)(C(A))},t.\u0275cmp=_({type:t,selectors:[["lcd-header"]],inputs:{line:"line"},decls:28,vars:12,consts:[[1,"lcd-header","lcd-header--grid"],[1,"lcd-header__logo-container"],["src","assets/logo.png","alt","Jinan Metro Logo",1,"lcd-header__logo"],[1,"lcd-header__line-number"],[1,"lcd-header__line-number__text"],[1,"lcd-header__line-number__text__ch"],[1,"lcd-header__line-number__text__en"],[1,"lcd-header__station"],[1,"lcd-header__dest"],[1,"lcd-header__dest__a"],[1,"lcd-header__dest__cn"],[1,"lcd-header__dest__en"],[1,"lcd-header__dest__splitor"],["color","var(--foreground-color)"],[1,"lcd-header__dest__b"],[1,"lcd-header__station__prefix"],[1,"lcd-header__station__cn"],[1,"lcd-header__station__en"],[1,"lcd-header__station__station-name"]],template:function(n,e){if(n&1&&(r(0,"div",0)(1,"div",1),g(2,"img",2),l(),r(3,"div",3)(4,"span"),p(5),l(),r(6,"div",4)(7,"span",5),p(8),l(),r(9,"span",6),p(10),I(11,"lineName"),l()()(),r(12,"div",7),y(13,tt,2,1),I(14,"async"),l(),r(15,"div",8)(16,"div",9)(17,"span",10),p(18),l(),r(19,"span",11),p(20),l()(),r(21,"div",12),g(22,"lcd-splitor",13),l(),r(23,"div",14)(24,"span",10),p(25),l(),r(26,"span",11),p(27),l()()()()),n&2){let a;d(5),S(e.line.nameCh.main),d(3),F(" ",e.line.nameCh.suffix," "),d(2),F(" ",L(11,8,e.line.nameEn)," "),d(3),O(13,(a=L(14,10,e.running$))?13:-1,a),d(5),S(e.line.from.nameCh),d(2),S(e.line.from.nameEn),d(5),S(e.line.to.nameCh),d(2),S(e.line.to.nameEn)}},dependencies:[ie,q,Ae,oe],styles:[".lcd-header[_ngcontent-%COMP%]{padding:8px 64px 8px 72px;height:96px;display:flex;flex-direction:row;background-color:var(--line-color)}.lcd-header__logo-container[_ngcontent-%COMP%]{flex:0 0;display:flex;flex-direction:column;justify-content:center;padding:8px;background-color:#fff;border-radius:8px}.lcd-header__logo[_ngcontent-%COMP%]{height:100%}.lcd-header__line-number[_ngcontent-%COMP%]{flex:0 0;margin-left:32px;display:flex;flex-direction:row;word-break:keep-all;white-space:nowrap;align-items:center;color:var(--foreground-color)}.lcd-header__line-number[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{font-weight:700;font-size:98px;line-height:96px}.lcd-header__line-number__text[_ngcontent-%COMP%]{margin-left:8px;display:flex;flex-direction:column;justify-content:center}.lcd-header__line-number__text__ch[_ngcontent-%COMP%]{font-size:48px;line-height:1.2}.lcd-header__line-number__text__en[_ngcontent-%COMP%]{font-size:28px}.lcd-header__station[_ngcontent-%COMP%]{flex:1 1;margin:-8px 40px;min-width:34.5834%;display:flex;flex-direction:row;align-items:center;justify-content:space-evenly;border-radius:0 0 8px 8px;background-color:#fff;box-shadow:2px 2px 5px #000000a6}.lcd-header__station__prefix[_ngcontent-%COMP%], .lcd-header__station__station-name[_ngcontent-%COMP%]{padding:0 40px;display:flex;flex-direction:column;word-break:keep-all;white-space:nowrap;text-align:center}.lcd-header__station__cn[_ngcontent-%COMP%]{font-weight:700;font-size:48px;line-height:1.2}.lcd-header__station__en[_ngcontent-%COMP%]{font-size:28px}.lcd-header__dest[_ngcontent-%COMP%]{flex:1 0;display:flex;flex-direction:row;align-items:center;justify-content:flex-end;color:var(--foreground-color)}.lcd-header__dest__splitor[_ngcontent-%COMP%]{margin:0 24px;font-size:48px}.lcd-header__dest__cn[_ngcontent-%COMP%]{font-size:48px;line-height:1.2}.lcd-header__dest__en[_ngcontent-%COMP%]{font-size:28px}.lcd-header__dest__a[_ngcontent-%COMP%], .lcd-header__dest__b[_ngcontent-%COMP%]{display:flex;flex-direction:column;word-break:keep-all;white-space:nowrap;text-align:center}.lcd-header--grid[_ngcontent-%COMP%]{display:grid;grid-template-rows:100%;grid-template-columns:repeat(2,1fr) repeat(2,3fr);column-gap:32px}.lcd-header--grid[_ngcontent-%COMP%]   .lcd-header__line-number[_ngcontent-%COMP%]{margin-left:0}.lcd-header--grid[_ngcontent-%COMP%]   .lcd-header__station[_ngcontent-%COMP%]{justify-self:stretch;margin-right:0;margin-left:0}"]});let i=t;return i})();var $=(()=>{let t=class t{get config$(){return this.configSubject.asObservable()}get config(){return this.configSubject.getValue()}constructor(){this.configSubject=new Z({nextOnAudioEnded:!0,nextGap:1e3,disabledStations:[]})}update(o){this.configSubject.next(Object.assign({},this.configSubject.value,o))}reset(o={}){this.configSubject.next(j({nextOnAudioEnded:!0,nextGap:1e3,disabledStations:[]},o))}toggleStationDisabled(o){let{disabledStations:n}=this.config,e;n.includes(o)?e=n.filter(a=>a!==o):e=[...n,o],this.update({disabledStations:e})}};t.\u0275fac=function(n){return new(n||t)},t.\u0275prov=R({token:t,factory:t.\u0275fac});let i=t;return i})();var Ze=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=_({type:t,selectors:[["lcd-transfer-icon"]],hostVars:4,hostBindings:function(n,e){n&2&&T("--primary-color",e.mainColor)("--secondary-color",e.transferColor||e.mainColor)},inputs:{mainColor:"mainColor",transferColor:"transferColor"},decls:3,vars:0,consts:[["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 512 512",1,"svg-inline--fa"],["d","M16 312v7.6 .7V440c0 9.7 5.8 18.5 14.8 22.2s19.3 1.7 26.2-5.2l41.6-41.6c87.6 86.5 228.7 86.2 315.8-1c24.4-24.4 42.1-53.1 52.9-83.7c5.9-16.7-2.9-34.9-19.5-40.8s-34.9 2.9-40.8 19.5c-7.7 21.8-20.2 42.3-37.8 59.8c-62.2 62.2-162.7 62.5-225.3 1L185 329c6.9-6.9 8.9-17.2 5.2-26.2s-12.5-14.8-22.2-14.8H48.4h-.7H40c-13.3 0-24 10.7-24 24z",2,"fill","var(--primary-color)"],["d","M142.9 142.9c62.2-62.2 162.7-62.5 225.3-1L327 183c-6.9 6.9-8.9 17.2-5.2 26.2s12.5 14.8 22.2 14.8H463.5c0 0 0 0 0 0H472c13.3 0 24-10.7 24-24V72c0-9.7-5.8-18.5-14.8-22.2s-19.3-1.7-26.2 5.2L413.4 96.6c-87.6-86.5-228.7-86.2-315.8 1C73.2 122 55.6 150.7 44.8 181.4c-5.9 16.7 2.9 34.9 19.5 40.8s34.9-2.9 40.8-19.5c7.7-21.8 20.2-42.3 37.8-59.8z",2,"fill","var(--secondary-color)"]],template:function(n,e){n&1&&(_e(),r(0,"svg",0),g(1,"path",1)(2,"path",2),l())},encapsulation:2,changeDetection:0});let i=t;return i})();var He=(()=>{let t=class t{constructor(o){this.containerConfigService=o}setFrom(){this.containerConfigService.update({from:this.station.id})}toggleEnabled(){this.containerConfigService.toggleStationDisabled(this.station.id)}setTo(){if(this.line){let{from:o,stations:n}=this.line,e=n.findIndex(u=>u.id===o.id),a=n.findIndex(u=>u.id===this.station.id);if(a===e){alert("\u8D77\u59CB\u7AD9\u548C\u7EC8\u70B9\u7AD9\u4E0D\u80FD\u4E3A\u540C\u4E00\u7AD9");return}else if(a<e){alert("\u7EC8\u70B9\u7AD9\u4E0D\u80FD\u5728\u8D77\u59CB\u7AD9\u524D");return}}this.containerConfigService.update({to:this.station.id})}};t.\u0275fac=function(n){return new(n||t)(C($))},t.\u0275cmp=_({type:t,selectors:[["lcd-station-toolbar"]],hostAttrs:[1,"lcd-station__toolbar"],inputs:{line:"line",station:"station"},decls:6,vars:1,consts:[[1,"lcd-station__toolbar-item",3,"click"]],template:function(n,e){n&1&&(r(0,"div",0),h("click",function(){return e.setFrom()}),p(1,` \u8D77
`),l(),r(2,"div",0),h("click",function(){return e.toggleEnabled()}),p(3),l(),r(4,"div",0),h("click",function(){return e.setTo()}),p(5,` \u7EC8
`),l()),n&2&&(d(3),F(" ",e.station.disabled?"\u542F":"\u7981",`
`))},styles:[`.lcd-station__toolbar{position:absolute;top:48px;right:0;display:flex;flex-direction:row;padding:4px 0;background-color:#fff;border-radius:4px;box-shadow:0 2px 10px #0006;transform:translate(calc(50% - 20px));display:none}.lcd-station--showing-editing-bar .lcd-station__toolbar{display:flex}.lcd-station__toolbar-item{margin:0 4px;display:flex;flex-direction:column;align-items:center;width:24px;height:24px;border:1px solid rgba(0,0,0,.4);border-radius:50%;cursor:pointer}.lcd-station__toolbar-item:hover{box-shadow:2px 2px 7px -3px #0006}
`],encapsulation:2,changeDetection:0});let i=t;return i})();var at=(i,t)=>t.id;function rt(i,t){if(i&1&&g(0,"lcd-transfer-icon",4),i&2){let m=x();f("transferColor",m.station.transfers==null||m.station.transfers[0]==null?null:m.station.transfers[0].color)}}function lt(i,t){if(i&1){let m=M();r(0,"fa-icon",11),h("click",function(){E(m);let n=x();return P(n.toggleEditingBar())}),l()}if(i&2){let m=x();f("icon",m.settingIcon)}}function st(i,t){i&1&&(r(0,"span",8),p(1,"(\u6682\u7F13\u5F00\u901A)"),l())}function ct(i,t){if(i&1&&(r(0,"div",13)(1,"span",14),p(2),I(3,"lineName"),l(),r(4,"span",15),p(5),I(6,"lineName"),l()()),i&2){let m=t.$implicit;T("--transfer-line-color",m.color),k("lcd-station__transfer--disabled",m.disabled),d(2),S(L(3,6,m.nameCh)),d(3),S(L(6,8,m.nameEn))}}function dt(i,t){if(i&1&&(r(0,"div",9),B(1,ct,7,10,"div",12,at),l()),i&2){let m=x();d(),D(m.station.transfers)}}function pt(i,t){if(i&1&&g(0,"lcd-station-toolbar",10),i&2){let m=x();f("line",m.line)("station",m.station)}}var Re=(()=>{let t=class t{get transferrable(){return this.station?.transfers?.some(o=>!o.disabled)??!1}get config(){return this.containerConfigService.config}constructor(o){this.containerConfigService=o,this.settingIcon=Me,this.StationStatus=s,this.showEditingBar=!1}toggleEditingBar(){this.showEditingBar=!this.showEditingBar}clickOutside(){this.showEditingBar=!1}};t.\u0275fac=function(n){return new(n||t)(C($))},t.\u0275cmp=_({type:t,selectors:[["lcd-station"]],inputs:{line:"line",station:"station"},decls:13,vars:19,consts:[[1,"lcd-station",3,"clickOutside","attachOutsideOnClick"],[1,"lcd-station__line"],["speed","faster",3,"animating","color"],[1,"lcd-station__point"],["mainColor","var(--line-color)",3,"transferColor"],[1,"lcd-station__info"],[1,"lcd-station__name__ch"],[1,"lcd-station__name__en",3,"innerHTML"],[1,"lcd-station__disabled"],[1,"lcd-station__transfers"],[3,"line","station"],[1,"lcd-station__setting-icon",3,"click","icon"],[1,"lcd-station__transfer",3,"lcd-station__transfer--disabled","--transfer-line-color"],[1,"lcd-station__transfer"],[1,"lcd-station__transfer__line__ch"],[1,"lcd-station__transfer__line__en"]],template:function(n,e){n&1&&(r(0,"div",0),h("clickOutside",function(){return e.clickOutside()}),r(1,"div",1),g(2,"lcd-splitor",2),l(),r(3,"div",3),y(4,rt,1,1,"lcd-transfer-icon",4)(5,lt,1,1),l(),r(6,"div",5)(7,"span",6),p(8),l(),g(9,"span",7),y(10,st,2,0,"span",8)(11,dt,3,0,"div",9),l(),y(12,pt,1,2,"lcd-station-toolbar",10),l()),n&2&&(k("lcd-station--transferrable",e.transferrable)("lcd-station--disabled",e.station.disabled)("lcd-station--arriving-soon",e.station.status===e.StationStatus.ArrivingSoon)("lcd-station--past",e.station.status===e.StationStatus.Past||e.station.status===e.StationStatus.NotInService)("lcd-station--showing-editing-bar",e.showEditingBar),f("attachOutsideOnClick",!0),d(2),f("animating",e.station.status==="arriving-soon")("color",e.station.status==="arriving-soon"?"red":"white"),d(2),O(4,e.transferrable?4:e.config.editing?5:-1),d(4),S(e.station.nameCh),d(),f("innerHTML",e.station.nameEn,xe),d(),O(10,e.station.disabled?10:-1),d(),O(11,e.station.transfers?11:-1),d(),O(12,e.config.editing?12:-1))},dependencies:[V,$e,ie,Ze,He,oe],styles:[`.lcd-station{position:relative;display:flex;flex-direction:row;align-items:center}.lcd-station--disabled{color:#e9e9e9}.lcd-station--disabled :not(.lcd-station__line){filter:grayscale(100%)}.lcd-station--past{color:#e9e9e9}.lcd-station--past:not(.just-priority){filter:grayscale(100%)}.lcd-station__point{position:relative;width:40px;height:40px;border:4px solid var(--line-color);border-radius:50%;background-color:#fff;text-align:center;font-size:24px;line-height:32px;z-index:30}.lcd-station__setting-icon{display:none}.lcd-station--transferrable:not(.lcd-station--disabled) .lcd-station__point{animation:1.75s ease-in infinite transferrable-station}.lcd-station--arriving-soon .lcd-station__point{background-color:var(--line-color)}.lcd-station__line{flex-grow:1;margin-inline:-4px;height:24px;background-color:var(--line-color);z-index:-1;text-align:center}.lcd-station__line lcd-splitor{display:inline;font-size:24px;line-height:24px;z-index:20}.lcd-station__line lcd-splitor :nth-child(n+4){display:none}.lcd-station__info{position:absolute;top:48px;right:0;display:flex;flex-direction:column;word-break:keep-all;white-space:nowrap;transform:translate(calc(50% - 20px));text-align:center}.lcd-station:not(.lcd-station--past,.lcd-station--disabled) .lcd-station__name__ch,.lcd-station:not(.lcd-station--past,.lcd-station--disabled) .lcd-station__name__en{text-shadow:1px 1px 1px rgba(0,0,0,.1)}.lcd-station__transfers{align-self:center}.lcd-station__transfer{margin:4px 0;padding:4px 16px;display:flex;flex-direction:column;word-break:keep-all;white-space:nowrap;border-radius:8px;color:#fff;background-color:var(--transfer-line-color)}.lcd-station__transfer--disabled,.lcd-station--disabled .lcd-station__transfer{background-color:#e9e9e9}.lcd-station:hover .lcd-station__setting-icon,.lcd-station--showing-editing-bar .lcd-station__setting-icon{display:initial}lcd-station:first-child .lcd-station__line{display:none}lcd-station:nth-child(2n) .lcd-station__info{transform:translate(calc(50% - 20px),calc(-56px - 100%))}lcd-station:nth-child(2n) .lcd-station__info .lcd-station__transfers{order:-1}@keyframes transferrable-station{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`],encapsulation:2});let i=t;return i})();var ut=(i,t)=>t.id;function ft(i,t){if(i&1&&g(0,"lcd-station",2),i&2){let m=t.$implicit,o=x();f("line",o.line)("station",m)}}var ze=(()=>{let t=class t{get stations(){return this.line?.stations??[]}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=_({type:t,selectors:[["lcd-route"]],hostAttrs:[1,"lcd-route"],hostVars:2,hostBindings:function(n,e){n&2&&T("--rest-station-count",e.stations.length-1)},inputs:{line:"line"},decls:4,vars:0,consts:[[1,"lcd-route__station-container"],[1,"lcd-route__stations"],[3,"line","station"]],template:function(n,e){n&1&&(r(0,"div",0)(1,"div",1),B(2,ft,1,2,"lcd-station",2,ut),l()()),n&2&&(d(2),D(e.stations))},dependencies:[Re],styles:[".lcd-route__station-container[_ngcontent-%COMP%]{padding:128px 64px 0}.lcd-route__stations[_ngcontent-%COMP%]{display:grid;grid-template-columns:40px repeat(var(--rest-station-count),1fr);align-items:start}"]});let i=t;return i})();var Ge=(()=>{let t=class t{get line(){return this._line}set line(o){this._line=o,this.lineSubject.next(o)}get lineColor(){return this.runningLine.color}get config(){return this.containerConfigService.config}constructor(o,n){this.runningLineService=o,this.containerConfigService=n,this.lineSubject=new ue,this.lineSubject.pipe(ge(e=>{this.containerConfigService.reset({disabledStations:e.stations.filter(a=>a.disabled).map(a=>a.id)})}),fe(this.containerConfigService.config$)).subscribe(([e,a])=>{this.runningLine=this.runningLineService.init(e,a)})}};t.\u0275fac=function(n){return new(n||t)(C(A),C($))},t.\u0275cmp=_({type:t,selectors:[["lcd-container"]],hostVars:4,hostBindings:function(n,e){n&2&&T("--foreground-color",e.line.ui.foregroundColor||"#000")("--line-color",e.lineColor)},inputs:{line:"line"},decls:2,vars:2,consts:[[3,"line"]],template:function(n,e){n&1&&g(0,"lcd-header",0)(1,"lcd-route",0),n&2&&(f("line",e.runningLine),d(),f("line",e.runningLine))},dependencies:[Ne,ze],styles:["[_nghost-%COMP%]{display:block;min-width:1920px;font-family:PingFang SC,Hei}.ops[_ngcontent-%COMP%]{position:fixed;bottom:0}"]});let i=t;return i})();var vt=["audio"],xt=i=>({$implicit:i});function Ct(i,t){i&1&&Q(0)}function yt(i,t){if(i&1){let m=M();r(0,"button",4),h("click",function(){let n=E(m).$implicit;return P(n.play())}),p(1,"Play"),l(),r(2,"button",4),h("click",function(){let n=E(m).$implicit;return P(n.pause())}),p(3,"Pause"),l(),r(4,"button",4),h("click",function(){let n=E(m).$implicit;return P(n.next())}),p(5,"Next"),l()}if(i&2){let m=x();f("disabled",m.disabled),d(2),f("disabled",m.disabled),d(2),f("disabled",m.disabled)}}var Qe=(()=>{let t=class t{constructor(){this.disabled=!1,this.ended=new ve,this.autoplay=!1,this.playingIndex=-1}set playlist(o){this._playlist=[...o],this.playingIndex=-1,this.next()}get playing(){return this._playlist?.[this.playingIndex]}get context(){return{play:this.play.bind(this),pause:this.pause.bind(this),next:this.next.bind(this)}}ngAfterViewInit(){this.playing&&this.playingIndex!==0&&this.audio.nativeElement.play()}play(){this.autoplay=!0,this.audio?.nativeElement?.play?.()}pause(){this.audio?.nativeElement?.pause?.()}next(){let o=this.playingIndex+1;return o===this._playlist?.length?!1:(this.playingIndex=o,setTimeout(()=>this.audio?.nativeElement?.load?.()),!0)}audioLoaded(o){let n=o.target;(this.autoplay||this.playingIndex!==0)&&n.play()}audioEnded(){this.next()||this.ended.emit()}};t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=_({type:t,selectors:[["lcd-player"]],viewQuery:function(n,e){if(n&1&&ye(vt,5),n&2){let a;Se(a=be())&&(e.audio=a.first)}},inputs:{controls:"controls",disabled:"disabled",playlist:"playlist"},outputs:{ended:"ended"},decls:5,vars:5,consts:[["audio",""],["defaultControls",""],[3,"canplaythrough","ended","src"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["mat-stroked-button","",3,"click","disabled"]],template:function(n,e){if(n&1){let a=M();r(0,"audio",2,0),h("canplaythrough",function(w){return E(a),P(e.audioLoaded(w))})("ended",function(){return E(a),P(e.audioEnded())}),l(),y(2,Ct,1,0,"ng-container",3)(3,yt,6,3,"ng-template",null,1,K)}if(n&2){let a=W(4);f("src",e.playing,Ce),d(2),f("ngTemplateOutlet",e.controls||a)("ngTemplateOutletContext",Y(3,xt,e.context))}},dependencies:[X,U]});let i=t;return i})();var wt=()=>[],Et=i=>({$implicit:i});function Pt(i,t){i&1&&Q(0)}function Tt(i,t){if(i&1&&y(0,Pt,1,0,"ng-container",18),i&2){let m=x();f("ngTemplateOutlet",m.customOperation)("ngTemplateOutletContext",Y(2,Et,m.config))}}var We=(()=>{let t=class t{get config(){return this.containerConfigService.config}get playlist$(){return this.runningLineService.playlist$}constructor(o,n){this.runningLineService=o,this.containerConfigService=n,this.collapseIcon=Fe,this.collapsed=!1}togglePanel(){this.collapsed=!this.collapsed}moveNext(){this.runningLineService.next()}onPlayerEnded(){this.config.nextOnAudioEnded&&setTimeout(()=>this.moveNext(),this.config.nextGap)}_updateConfig(o,n){this.containerConfigService.update({[o]:n})}updateConfig(o,n){this._updateConfig(o,n.target.value)}updateBooleanConfig(o,n){this._updateConfig(o,n.checked)}};t.\u0275fac=function(n){return new(n||t)(C(A),C($))},t.\u0275cmp=_({type:t,selectors:[["lcd-operation-panel"]],hostAttrs:[1,"lcd-operation-panel"],hostVars:2,hostBindings:function(n,e){n&2&&k("lcd-operation-panel--collapsed",e.collapsed)},inputs:{customOperation:"customOperation"},decls:44,vars:11,consts:[[1,"lcd-operation-panel__header"],[1,"lcd-operation-panel__footer"],["href","https://space.bilibili.com/4946860","target","_blank","referrerpolicy","no-referrer",2,"text-decoration","none"],["href","https://github.com/RVC-Boss/GPT-SoVITS","target","_blank","referrerpolicy","no-referrer"],["href","https://angular.io","target","_blank","referrerpolicy","no-referrer"],["href","https://fontawesome.com","target","_blank","referrerpolicy","no-referrer"],[1,"lcd-operation-panel__toggle",3,"click"],[3,"icon"],[1,"lcd-operation-panel__content"],[1,"lcd-operation-panel__category"],[1,"lcd-operation-panel__category__title"],[1,"lcd-operation-panel__operation-item"],["mat-stroked-button","",3,"click","disabled"],[3,"change","checked"],["subscriptSizing","dynamic"],["matInput","","type","number","min","0","step","100",2,"width","80px",3,"change","value"],["type","checkbox",3,"change","checked"],[3,"ended","playlist","disabled"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(n,e){n&1&&(r(0,"div",0)(1,"div",1),p(2," \u4F5C\u8005\uFF1A\u3010bilibili\u3011"),r(3,"a",2),p(4,"\u8F71\u8F98\u662F\u795E\u68CD"),l(),p(5,"\xA0\xA0Powered by "),r(6,"a",3),p(7,"GPT-SoVITS"),l(),p(8,", "),r(9,"a",4),p(10,"Angular"),l(),p(11,", "),r(12,"a",5),p(13,"FontAwesome"),l(),p(14,"\xA0\xA0\u8BF7\u52FF\u8F6C\u8F7D "),l(),r(15,"div",6),h("click",function(){return e.togglePanel()}),g(16,"fa-icon",7),l()(),r(17,"div",8),y(18,Tt,1,4,"ng-container"),r(19,"div",9)(20,"div",10),p(21,"LCD Control"),l(),r(22,"span",11)(23,"button",12),h("click",function(){return e.moveNext()}),p(24,"Next"),l()(),g(25,"br"),r(26,"span",11)(27,"mat-slide-toggle",13),h("change",function(u){return e.updateBooleanConfig("nextOnAudioEnded",u)}),p(28,"Move Next When Audio Ended"),l()(),r(29,"span",11)(30,"mat-form-field",14)(31,"mat-label"),p(32,"Move Gap Time(ms):"),l(),r(33,"input",15),h("change",function(u){return e.updateConfig("nextGap",u)}),l()()(),g(34,"br"),r(35,"span",11)(36,"mat-slide-toggle",16),h("change",function(u){return e.updateBooleanConfig("editing",u)}),p(37,"Edit Station Mode (\u26A0Will Lose Current Running Status)"),l()()(),r(38,"div",9)(39,"div",10),p(40,"Voice Control"),l(),r(41,"div",11)(42,"lcd-player",17),I(43,"async"),h("ended",function(){return e.onPlayerEnded()}),l()()()()),n&2&&(d(16),f("icon",e.collapseIcon),d(2),O(18,e.customOperation?18:-1),d(5),f("disabled",e.config.editing),d(4),f("checked",e.config.nextOnAudioEnded),d(6),f("value",e.config.nextGap),d(3),f("checked",e.config.editing),d(6),f("playlist",L(43,8,e.playlist$)||Ee(10,wt))("disabled",e.config.editing))},dependencies:[X,V,U,te,ee,Oe,Le,Qe,q],styles:[`.lcd-operation-panel{position:fixed;right:0;bottom:0;left:0;display:flex;flex-direction:column;padding:0 32px 32px;height:256px;transition:height .25s ease-in-out;box-shadow:0 0 10px #0006}.lcd-operation-panel--collapsed{padding:0;min-height:initial;height:50.4px}.lcd-operation-panel--collapsed .lcd-operation-panel__toggle{transform:rotate(-180deg)}.lcd-operation-panel--collapsed .lcd-operation-panel__footer{padding-top:16.2px;padding-bottom:16.2px}.lcd-operation-panel--collapsed>:not(.lcd-operation-panel__header){display:none}.lcd-operation-panel__content{display:flex;flex-direction:row;column-gap:32px;padding:16px 0}.lcd-operation-panel__category{font-weight:500}.lcd-operation-panel__category__title{margin-bottom:8px}.lcd-operation-panel__footer{padding:7px 0;color:#e9e9e9;line-height:18px;text-align:center}.lcd-operation-panel__footer a:active,.lcd-operation-panel__footer a:visited{color:inherit}.lcd-operation-panel__footer a:hover{color:var(--line-color)}.lcd-operation-panel__toggle{position:absolute;top:0;right:0;padding:16px;cursor:pointer;transition:transform .25s ease-in}.lcd-operation-panel button+button,.lcd-operation-panel__operation-item+.lcd-operation-panel__operation-item{margin-left:8px}
`],encapsulation:2});let i=t;return i})();var de={};qe(de,{Line2:()=>Ye});var N="common/TrainRunning.wav",re="common/HeartSeat.wav";var c="02/",v=[`${c}Common-0201.wav`],Ye={ui:{get title(){return"Jinan Metro Line 2"}},id:"02",nameCh:{main:"2",suffix:"\u53F7\u7EBF"},nameEn:{prefix:"Line ",main:"2"},color:"#FEDD00",direction:"up",stations:[{id:"0201",nameCh:"\u738B\u5E9C\u5E84",nameEn:"Wang Fu Zhuang",transfers:[{id:"01",nameCh:{main:"1",suffix:"\u53F7\u7EBF"},nameEn:{prefix:"Line ",main:"1"},color:"#A55FC8"}],voices:{[s.ArrivingSoon]:{ch:[`${c}01-WangFuZhuang-T.wav`,`${c}01-WangFuZhuang-01.wav`,`${c}01-WangFuZhuang-0101.wav`],en:[]},[s.Arrived]:{ch:[`${c}01-WangFuZhuang-02.wav`,...v],en:[]}}},{id:"0202",nameCh:"\u814A\u5C71\u5357",nameEn:"La Shan Nan",voices:{[s.ArrivingSoon]:{ch:[`${c}19-PengJiaZhuang-T.wav`,`${c}02-LaShanNan-01.wav`,N],en:[]},[s.Arrived]:{ch:[`${c}02-LaShanNan-02.wav`,...v],en:[]}}},{id:"0203",nameCh:"\u814A\u5C71",nameEn:"La Shan",voices:{[s.ArrivingSoon]:{ch:[`${c}19-PengJiaZhuang-T.wav`,`${c}03-LaShan-01.wav`],en:[]},[s.Arrived]:{ch:[`${c}03-LaShan-02.wav`,...v],en:[]}}},{id:"0204",nameCh:"\u4E8C\u73AF\u897F\u8DEF",nameEn:"Er Huan Xi Lu",voices:{[s.ArrivingSoon]:{ch:[`${c}19-PengJiaZhuang-T.wav`,`${c}04-ErHuanXiLu-01.wav`,re],en:[]},[s.Arrived]:{ch:[`${c}04-ErHuanXiLu-02.wav`,...v],en:[]}}},{id:"0205",nameCh:"\u8001\u5C6F",nameEn:"Lao Tun",voices:{[s.ArrivingSoon]:{ch:[`${c}19-PengJiaZhuang-T.wav`,`${c}05-LaoTun-01.wav`],en:[]},[s.Arrived]:{ch:[`${c}05-LaoTun-02.wav`,...v],en:[]}}},{id:"0206",nameCh:"\u516B\u91CC\u6865",nameEn:"Ba Li Qiao",voices:{[s.ArrivingSoon]:{ch:[`${c}19-PengJiaZhuang-T.wav`,`${c}06-BaLiQiao-01.wav`],en:[]},[s.Arrived]:{ch:[`${c}06-BaLiQiao-02.wav`,...v],en:[]}}},{id:"0207",nameCh:"\u76CA\u5EB7\u8DEF",nameEn:"Yi Kang Lu",voices:{[s.ArrivingSoon]:{ch:[`${c}19-PengJiaZhuang-T.wav`,`${c}07-YiKangLu-01.wav`,N],en:[]},[s.Arrived]:{ch:[`${c}07-YiKangLu-02.wav`,...v],en:[]}}},{id:"0208",nameCh:"\u6D4E\u5357\u7AD9\u5317",nameEn:"Jinan Railway<br/>Station North",voices:{[s.ArrivingSoon]:{ch:[`${c}19-PengJiaZhuang-T.wav`,`${c}08-JinanRailwayStationNorth-01.wav`],en:[]},[s.Arrived]:{ch:[`${c}08-JinanRailwayStationNorth-02.wav`,...v],en:[]}}},{id:"0209",nameCh:"\u6D4E\u6CFA\u8DEF",nameEn:"Ji Luo Lu",voices:{[s.ArrivingSoon]:{ch:[`${c}19-PengJiaZhuang-T.wav`,`${c}09-JiLuoLu-01.wav`],en:[]},[s.Arrived]:{ch:[`${c}09-JiLuoLu-02.wav`,...v],en:[]}}},{id:"0210",nameCh:"\u751F\u4EA7\u8DEF",nameEn:"Sheng Chan Lu",voices:{[s.ArrivingSoon]:{ch:[`${c}19-PengJiaZhuang-T.wav`,`${c}10-ShengChanLu-01.wav`,re],en:[]},[s.Arrived]:{ch:[`${c}10-ShengChanLu-02.wav`,...v],en:[]}}},{id:"0211",nameCh:"\u5317\u56ED",nameEn:"Bei Yuan",voices:{[s.ArrivingSoon]:{ch:[`${c}19-PengJiaZhuang-T.wav`,`${c}11-BeiYuan-01.wav`],en:[]},[s.Arrived]:{ch:[`${c}11-BeiYuan-02.wav`,...v],en:[]}}},{id:"0212",nameCh:"\u5386\u5C71\u8DEF",nameEn:"Li Shan Lu",voices:{[s.ArrivingSoon]:{ch:[`${c}19-PengJiaZhuang-T.wav`,`${c}12-LiShanLu-01.wav`],en:[]},[s.Arrived]:{ch:[`${c}12-LiShanLu-02.wav`,...v],en:[]}}},{id:"0213",nameCh:"\u4E03\u91CC\u5821",nameEn:"Qi Li Pu",voices:{[s.ArrivingSoon]:{ch:[`${c}19-PengJiaZhuang-T.wav`,`${c}13-QiLiPu-01.wav`,N],en:[]},[s.Arrived]:{ch:[`${c}13-QiLiPu-02.wav`,...v],en:[]}}},{id:"0214",nameCh:"\u795D\u7538",nameEn:"Zhu Dian",voices:{[s.ArrivingSoon]:{ch:[`${c}19-PengJiaZhuang-T.wav`,`${c}14-ZhuDian-01.wav`],en:[]},[s.Arrived]:{ch:[`${c}14-ZhuDian-02.wav`,...v],en:[]}}},{id:"0215",nameCh:"\u516B\u6DA7\u5821",nameEn:"Ba Jian Pu",voices:{[s.ArrivingSoon]:{ch:[`${c}19-PengJiaZhuang-T.wav`,`${c}15-BaJianPu-01.wav`,`${c}15-BaJianPu-0101.wav`],en:[]},[s.Arrived]:{ch:[`${c}15-BaJianPu-02.wav`,...v],en:[]}},transfers:[{id:"03",nameCh:{main:"3",suffix:"\u53F7\u7EBF"},nameEn:{prefix:"Line ",main:"3"},color:"#004B87"}]},{id:"0216",nameCh:"\u59DC\u5BB6\u5E84",nameEn:"Jiang Jia Zhuang",voices:{[s.ArrivingSoon]:{ch:[`${c}19-PengJiaZhuang-T.wav`,`${c}16-JiangJiaZhuang-01.wav`,re],en:[]},[s.Arrived]:{ch:[`${c}16-JiangJiaZhuang-02.wav`,...v],en:[]}}},{id:"0217",nameCh:"\u51E4\u51F0\u8DEF",nameEn:"Feng Huang Lu",voices:{[s.ArrivingSoon]:{ch:[`${c}19-PengJiaZhuang-T.wav`,`${c}17-FengHuangLu-01.wav`],en:[]},[s.Arrived]:{ch:[`${c}17-FengHuangLu-02.wav`,...v],en:[]}}},{id:"0218",nameCh:"\u9C8D\u5C71",nameEn:"Bao Shan",voices:{[s.ArrivingSoon]:{ch:[`${c}19-PengJiaZhuang-T.wav`,`${c}18-BaoShan-01.wav`,N],en:[]},[s.Arrived]:{ch:[`${c}18-BaoShan-02.wav`,...v],en:[]}}},{id:"0219",nameCh:"\u5F6D\u5BB6\u5E84",nameEn:"Peng Jia Zhuang",voices:{[s.ArrivingSoon]:{ch:[`${c}19-PengJiaZhuang-T.wav`,`${c}19-PengJiaZhuang-01.wav`],en:[]},[s.Arrived]:{ch:[`${c}19-PengJiaZhuang-02.wav`,...v],en:[]}}}]};var It=(i,t)=>t.id;function Lt(i,t){if(i&1&&(r(0,"mat-option",6),p(1),l()),i&2){let m=t.$implicit;f("value",m),d(),S(m.ui.title)}}function $t(i,t){if(i&1){let m=M();r(0,"div",3)(1,"span",4)(2,"mat-form-field")(3,"mat-label"),p(4,"Line"),l(),r(5,"mat-select",5),h("valueChange",function(n){E(m);let e=x();return P(e.onLineChange(n))}),B(6,Lt,2,2,"mat-option",6,It),l()()()()}if(i&2){let m=t.$implicit,o=x();d(5),f("value",o.line)("disabled",m.editing),d(),D(o.lines)}}var Ke=(()=>{let t=class t{constructor(o){this.title=o,this.lines=Object.values(de),this.onLineChange(this.lines[0])}onLineChange(o){this.title.setTitle(o.ui.title||"Metro LCD"),this.line=o}};t.\u0275fac=function(n){return new(n||t)(C(Pe))},t.\u0275cmp=_({type:t,selectors:[["lcd-outlet"]],features:[we([A,$])],decls:4,vars:2,consts:[["customOperation",""],[3,"line"],[3,"customOperation"],[1,"lcd-operation-panel__category"],[1,"lcd-operation-panel__operation-item"],[3,"valueChange","value","disabled"],[3,"value"]],template:function(n,e){if(n&1&&(g(0,"lcd-container",1)(1,"lcd-operation-panel",2),y(2,$t,8,2,"ng-template",null,0,K)),n&2){let a=W(3);f("line",e.line),d(),f("customOperation",a)}},dependencies:[te,ee,Ie,Te,Ge,We]});let i=t;return i})();var At=[{path:"",component:Ke}],Xe=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=G({type:t}),t.\u0275inj=z({imports:[le.forChild(At),le]});let i=t;return i})();var Qn=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=G({type:t}),t.\u0275inj=z({imports:[ke,Xe]});let i=t;return i})();export{Qn as LcdModule};
